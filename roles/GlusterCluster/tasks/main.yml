--- # main task list for GlusterCluster

- apt_repository:
    repo: 'ppa:gluster/glusterfs-3.8'
    state: present
    update_cache: yes


- name: Install glusterfs-server
  apt:
    name: glusterfs-server
    state: latest

- name: Install xfsprogs
  apt:
    name : xfsprogs
    state: latest


- filesystem: 
    fstype: xfs
    dev: /dev/xvdb1


- name: Mount second volume, even after boot
  mount:
    name: /export/xvdb1
    src: /dev/xvdb1
    fstype: xfs
    state: mounted

- file:
    path: /export/xvdb1/brick1
    state: directory

- name: Create Gluster Cluster
  gluster_volume:
    state: started
    start_on_create: yes
    name: brick1
    bricks: /export/xvdb1/brick
    cluster: tag_Gluster_Cluster
    replicas: 2
  run_once: yes